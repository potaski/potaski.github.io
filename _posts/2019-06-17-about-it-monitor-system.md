---
layout: post
title:  "IT监控系统随想"
categories: IT运维杂谈
tags: 监控系统
author: ZhangWei
---

* content
{:toc}

> 最近入职一家创业公司做运维工具开发，第一件事情就是监控系统建设

## 监控定位

**监控系统必须要拔高且做到统一**

运维系统工具五花八门，它们的诞生都有各自用途和目的，这很OK

监控系统，作为数据中心这个大战场的侦察员，是必须要做到全面监控和全面共享

现在企业都喜欢自上而下拆分成各个部门，遇到喜欢打架的人，真的是无法开展工作

应用运维是必须要了解出口带宽的使用情况，而网管是必须要了解主机业务是否被网络质量拖累的情况

不是说权责拆分，自管自己小摊摊就可以了；不够透明，无法沟通只能带来无尽的扯皮

上一个东家就是这样的。听说最近也要整改，祝好

现在新东家，有点往这方面发展的趋势...唉

## 监控管理

请让最优秀的人去负责监控系统，监控不是简单的A点到B点探测，也不是简单的False就告警

如何通过全局思考，发现问题的本质，去部署一个合理的有效的监控，是需要几点前提的：

1. 充分了解业务架构（各系统关系、主机规划、网络规划等）

2. 具有广泛的知识面（网络N层、常见硬件、OS、各种服务、基本代码等）

## 说说系统建设

吐槽完毕，讲讲系统本身

### 背景

新公司技术氛围还行，关于监控大家已经做了不少工作

1. 有一套Prometheus，但是仅是试用

2. 有一套Elasticsearch/Logstash，纳入了部分应用日志，但是面临日志格式繁杂的问题

3. 有一套监控竞品（目前还不知道用什么搭的）

4. 有一套Grafana，也仅为试用

5. 所有资源都是基于公有云，公有云有一套基本的监控

### 需求

1. 多个监控大屏，数据汇总及可视化

2. 系统拓扑图，故障指示

3. JMX监控、多种类业务监控

### 选型

大概分析了一下

重点是数据可视化，问题是数据源较多，也会采集其它业务系统中的数据。以一个人力（也就是我自己了）评估，把精力放在数据采集上更合适（真的很多...），做前端数据可视化并不是刚需，关键是老大觉得Grafana可以满足

看了一下Prometheus，是个好系统；但是web可视化界面差了点，关键是zabbix还提供拓扑图功能

就定下了下面这个实施方案：

1. Grafana做统一的可视化方案

2. Zabbix用以数据采集存储、告警、系统拓扑图

3. Elasticsearch/腾讯云/其它系统的数据等，视具体情况看是由Grafana直接显示，还是经由Zabbix采集再在Grafana显示

### 现状

Grafana已经建成，并配置了2个大屏的数据（但是屏幕还没有买回来）

Zabbix已经建成，建立了自己的模板，涵盖了基本监控及一些业务监控

Zabbix系统拓扑图及各节点关系监控正在部署，发现没有CMDB，这里面的关系不是很方便维护

### 未来

大概规划了一下关于CMDB/监控/作业等系统的建设方向

毕竟对资产管理、监控、运维自动化都有经验，但因为外部因素，从来没有打通过

所以想在这边从零开始实现整条流水线的自动化

突然老大说最近在考虑一个运维产品“优维科技”，OMG，项目要被吃掉

之前也了解过优维科技，是个不错的产品，理念跟我完全一致，如果真的用它，倒也和我完全对味
